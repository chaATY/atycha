---
title: YOLOv8提升检测性能
date: 2023-10-30
author: CHA.ATY
environment:
  - yolov8_11.8
tags:
  - AI
---

# 一、简介

下面介绍了如何提升检测性能、加快训练速度、减少训练超参和减少训练等方面进行说明。

下文介绍了YOLOv5作者分享如何提高模型指标的小技巧和吴恩达（Andrew Ng）在做缺陷检测项目（ steel sheets for defects）时需要提高模型指标的问题是如何解决的。

---

# 二、为什么？

通过一些方法可以有效提高模型的指标，提高精确率，召回率，mAP等。

---

# 三、数据集方面

1. 每个类别的图像：每个类别的图像张数大于1500张
2. 每个类别的实例：我们人工标注的目标框就是实例，每个类别的实例要大于10000张。
3. 类别不平衡：尽量保证每个类别标注数量不要像差1个数量级。
4. 图像的多样性：数据集必须展现出部署环境，推荐来自一天中不同时间、不同季节、不同天气、不同光照、不同角度、不同数据源（在线抓取、本地收集、不同相机）等的图像。
5. 标注的一致性：所有图像中所有类的所有实例都必须标注。部分标注将不起作用。
6. 标注的精度：边框必须紧密地包围每个目标。目标和边框之间不应存在任何空。任何目标都不应缺少标签。
7. 背景图像：背景图像是图像里没有感兴趣目标的图像，加到数据集以减少误报 （FP） 。建议约 0-10% 的背景图像，以帮助减少 FP（COCO数据集有1000张背景图像供参考，占总数的 1%）。
8. 多尺度训练：通过使用不同的图像尺寸进行训练，可以提高 YOLOv8 的准确性。这种方法可以在训练过程中使用多个尺度的图像，从而使模型能够更好地适应各种大小的物体。
9. 训练时使用的数据集与推理时使用的图片保持一致，大小不一致，可能会导致以下影响： 
	1. 性能下降：如果训练时使用的图片大小与推理时的大小不一致，可能会影响模型的性能。模型可能无法有效地泛化到新的图片尺寸上，导致检测精度下降。 
	2. 目标定位偏差：由于YOLOv在训练时学习了特定尺寸图片上的目标位置和特征，如果输入的图片尺寸与训练时不同，可能会导致目标定位的偏差。 
	3. 速度影响：由于模型要适应新的输入尺寸，可能会导致推理速度下降。这是因为模型需要调整以适应不同尺寸的输入。 为了避免这些问题，通常建议在训练和推理时使用相同大小的图片。如果需要适应不同大小的图片，可以通过插值等技术将图片调整为模型期望的大小，以确保模型在推理时能够得到准确的结果。

数据标注工具：[X-AnyLabeling 2.x](https://github.com/CVHub520/X-AnyLabeling/tree/main)、[Labelme](https://github.com/wkentaro/labelme)、[labelImg](https://github.com/HumanSignal/labelImg)

---

# 四、模型选择

模型越大，得到的结果越好，但是需要更多的CUDA内存去训练，且训练时间更长。对于移动部署，我们建议使用YOLOv5s/m；对于云部署，我们建议使用YOLOv5l/x。

小数据集（VOC）建议使用预训练模型做迁移学习，大数据集（COCO）可从头开始训练。

---

# 五、训练参数设置

第一次训练推荐使用默认设置，得到模型性能基线。

1. epochs：默认300个，出现过拟合则减小该值，反之亦然。
2. image_size：COCO数据集训练使用640分辨率，由于数据集中有大量的小目标，增加分辨率（如1280），有利于训练结果。如果客户数据集有很多小目标，使用原始像素或者更高像素有利于训练。想要获得好的模型推理结果则推理像素需与训练像素一致。
3. batch_size：使用硬件允许的最大值，需避免值过小产生糟糕的统计结果
4. hyperparameters（超参数）：默认的超参数在hyp.scratch.yaml文件中，一般情况下，增加augmentation参数可降低和推迟过拟合，以便于更长的训练获得更高的mAP值。减小类似[‘obj’]等损失增益的值也可降低过拟合。
5. 超参数优化：超参数是 YOLOv8 中的一些调整参数，例如学习率、正则化参数等。通过对这些超参数进行优化，可以提高算法的准确性。我们可以使用自动化工具如网格搜索、贝叶斯优化等来寻找最佳超参数组合。

---

# 六、模型集成

通过使用多个模型进行集成，可以提高 YOLOv8 的准确性。我们可以使用不同的预训练模型进行融合，例如 EfficientNet、ResNet 等。这种方法可以提高模型的鲁棒性和泛化能力。

---

# 七、修改损失函数

YOLOv8 的损失函数是非常关键的。通过修改损失函数，可以提高算法的准确性。例如，可以尝试使用更适合任务的损失函数，如 Focal Loss、IoU Loss 等。

---

# 八、分类器融合

对于一些特定的场景，例如在人脸检测中，我们可以使用分类器融合的方法来提高 YOLOv8 的准确性。这种方法可以结合多个分类器的结果，从而得到更准确的检测结果。

---

# 九、网络架构优化

YOLOv8 网络架构的优化也可以提高算法的准确性。例如，可以添加更多的卷积层或改变卷积层的大小等。这种方法可以改进模型的特征提取能力，从而提高模型的准确性。

---

# 十、后处理技术

在 YOLOv8 的检测结果中，可能存在一些误检或漏检的情况。为了进一步提高准确性，我们可以使用一些后处理技术，例如非极大值抑制（NMS）和边界框回归等。这些技术可以过滤掉一些冗余的检测结果，并对检测框进行微调，从而提高算法的准确性。

---

>版权声明©：
>
>本文为 CHA.ATY 的原创文章，遵循 [CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-sa/4.0/) 许可证进行授权，转载请附上原文出处链接及本声明。
>
>作者：CHA.ATY
>
>邮箱：2165150141@qq.com